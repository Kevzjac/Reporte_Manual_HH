<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reporte Manual de Horas Hombre - Departamento de Producción</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #10476b;
            color: #333;
            line-height: 1.6;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
            padding: 30px;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .header-content {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin-bottom: 15px;
        }
        
        .logo {
            width: 80px;
            height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #2c3e50;
            color: white;
            border-radius: 50%;
            font-weight: bold;
            font-size: 24px;
            background-image: url('logo.png');
        }
        
        .header-text {
            text-align: left;
        }
        
        h1 {
            color: #2c3e50;
            font-size: 28px;
            margin-bottom: 5px;
        }
        
        .company-name {
            font-size: 36px;
            color: #3498db;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .subtitle {
            color: #7f8c8d;
            font-size: 16px;
        }
        
        .form-section {
            margin-bottom: 25px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
        }
        
        input[type="text"], input[type="time"], select, input[type="password"] {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        input[type="text"]:focus, input[type="time"]:focus, select:focus, input[type="password"]:focus {
            border-color: #3498db;
            outline: none;
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
        }
        
        .employee-name {
            margin-top: 15px;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 5px;
            border-left: 4px solid #3498db;
            font-weight: 500;
            color: #2c3e50;
            min-height: 50px;
            display: flex;
            align-items: center;
        }
        
        .hidden {
            display: none;
        }
        
        .section-container {
            display: flex;
            gap: 20px;
            margin-top: 30px;
        }
        
        .section {
            flex: 1;
            padding: 20px;
            border-radius: 8px;
            background-color: #f8f9fa;
            transition: all 0.3s;
            cursor: pointer;
        }
        
        .section h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #ddd;
        }
        
        .form-row {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .form-group {
            flex: 1;
        }
        
        .btn-register {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            width: 100%;
            transition: background-color 0.3s;
            margin-top: 10px;
        }
        
        .btn-register:hover {
            background-color: #2980b9;
        }
        
        .disabled {
            opacity: 0.6;
            pointer-events: none;
        }
        
        .section.active {
            border: 2px solid #3498db;
            background-color: #e8f4fc;
        }
        
        .section.locked {
            border: 2px solid #e74c3c;
            background-color: #fdedec;
        }
        
        .lock-indicator {
            display: inline-block;
            margin-left: 10px;
            color: #e74c3c;
            font-size: 14px;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            background-color: #2ecc71;
            color: white;
            border-radius: 5px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            opacity: 0;
            transition: opacity 0.3s;
            z-index: 1000;
        }
        
        .notification.show {
            opacity: 1;
        }
        
        .notification.error {
            background-color: #e74c3c;
        }
        
        /* Estilos para la sección de consulta */
        .consult-section {
            margin-top: 40px;
            padding: 20px;
            background-color: #f8f9fa;
            border-radius: 8px;
        }
        
        .consult-section h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #ddd;
        }
        
        .consult-controls {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .consult-controls .form-group {
            flex: 1;
            min-width: 200px;
        }
        
        .btn-consult {
            background-color: #27ae60;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: background-color 0.3s;
        }
        
        .btn-consult:hover {
            background-color: #219653;
        }
        
        .results-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background-color: white;
            border-radius: 5px;
            overflow: hidden;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.05);
        }
        
        .results-table th, .results-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #eaeaea;
        }
        
        .results-table th {
            background-color: #3498db;
            color: white;
            font-weight: 600;
        }
        
        .results-table tr:hover {
            background-color: #f5f7fa;
        }
        
        .no-results {
            text-align: center;
            padding: 20px;
            color: #7f8c8d;
            font-style: italic;
        }
        
        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid #ddd;
        }
        
        .tab {
            padding: 10px 20px;
            cursor: pointer;
            background-color: #f8f9fa;
            border: 1px solid #ddd;
            border-bottom: none;
            border-radius: 5px 5px 0 0;
            margin-right: 5px;
        }
        
        .tab.active {
            background-color: #3498db;
            color: white;
            border-color: #3498db;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .btn-download {
            background-color: #e67e22;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: background-color 0.3s;
            margin-top: 15px;
            margin-right: 10px;
        }
        
        .btn-download:hover {
            background-color: #d35400;
        }
        
        .btn-delete {
            background-color: #e74c3c;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: background-color 0.3s;
            margin-top: 15px;
        }
        
        .btn-delete:hover {
            background-color: #c0392b;
        }
        
        .password-prompt {
            margin-top: 20px;
            padding: 15px;
            background-color: #fdedec;
            border: 1px solid #e74c3c;
            border-radius: 5px;
        }
        
        .password-prompt.hidden {
            display: none;
        }
        
        .password-input-group {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        .password-input-group input {
            flex: 1;
        }
        
        .btn-confirm {
            background-color: #e74c3c;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
        }
        
        .btn-cancel {
            background-color: #7f8c8d;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
        }
        
        @media (max-width: 768px) {
            .section-container {
                flex-direction: column;
            }
            
            .form-row {
                flex-direction: column;
                gap: 10px;
            }
            
            .header-content {
                flex-direction: column;
                text-align: center;
            }
            
            .header-text {
                text-align: center;
            }
            
            .consult-controls {
                flex-direction: column;
            }
            
            .results-table {
                display: block;
                overflow-x: auto;
            }
            
            .password-input-group {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="header-content">
                <div class="logo">ET</div>
                <div class="header-text">
                    <div class="company-name">ETec</div>
                    <h1>Reporte Manual de Horas Hombre</h1>
                    <div class="subtitle">Departamento de Producción</div>
                </div>
            </div>
            <p>Soluciones de Ingeniería para el Movimiento de Aguas</p>
        </header>
        
        <div class="tabs">
            <div class="tab active" data-tab="registro">Registrar Horas</div>
            <div class="tab" data-tab="consulta">Consultar Registros</div>
        </div>
        
        <div class="tab-content active" id="registro-tab">
            <main>
                <div class="form-section">
                    <label for="employee-id">ID Empleado</label>
                    <input type="text" id="employee-id" placeholder="Ingrese el código del empleado (E1, E2, etc.)">
                    <div id="employee-name" class="employee-name hidden">
                        <!-- El nombre del empleado aparecerá aquí -->
                    </div>
                </div>
                
                <div class="section-container">
                    <div class="section active" id="section-ejecuciones">
                        <h2>Ejecuciones <span id="lock-ejecuciones" class="lock-indicator hidden">🔒</span></h2>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="orden">Orden</label>
                                <input type="text" id="orden" placeholder="Número de orden">
                            </div>
                            <div class="form-group">
                                <label for="sufijo">Sufijo</label>
                                <input type="text" id="sufijo" placeholder="Sufijo">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="operacion">Operación</label>
                                <input type="text" id="operacion" placeholder="Operación">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="hora-inicio-ejecuciones">Hora Inicio</label>
                                <input type="time" id="hora-inicio-ejecuciones">
                            </div>
                            <div class="form-group">
                                <label for="hora-fin-ejecuciones">Hora Fin</label>
                                <input type="time" id="hora-fin-ejecuciones">
                            </div>
                        </div>
                        <button class="btn-register" id="btn-registrar-ejecuciones">Registrar</button>
                    </div>
                    
                    <div class="section" id="section-indirectos">
                        <h2>Indirectos <span id="lock-indirectos" class="lock-indicator hidden">🔒</span></h2>
                        <div class="form-group">
                            <label for="actividad">Actividad</label>
                            <select id="actividad">
                                <option value="">Seleccione una actividad</option>
                                <option value="5S">5S - PROGRAMA 5S</option>
                                <option value="ALM">ALM - TIEMPO DE ALMUERZO</option>
                                <option value="AMC">AMC - ADMINISTRACIÓN MESA CORTE</option>
                                <option value="APY">APY - APOYO</option>
                                <option value="AUS">AUS - AUSENCIA INJUSTIFICADA</option>
                                <option value="BVE">BVE - AUSENCIA POR BLOQUEO EN VIAS EXTERNAS</option>
                                <option value="CAP">CAP - CAPACITACIONES</option>
                                <option value="CDO">CDO - CALAMIDAD DOMESTICA</option>
                                <option value="CME">CME - CITAS MEDICAS</option>
                                <option value="COM">COM - COMPENSATORIO</option>
                                <option value="DC">DC - DESCANSO</option>
                                <option value="FEE">FEE - FALLA ENERGÍA ELECTRICA</option>
                                <option value="FEI">FEI - FALLA EQUIPO DE IZAJE DE CARGAS</option>
                                <option value="FHM">FHM - FABRICACION HERRAMIENTAS MANTENIMIENTO</option>
                                <option value="FHP">FHP - FABRICACION HERRAMIENTAS PRODUCCIÓN</option>
                                <option value="FMQ">FMQ - FALLA MAQUINA</option>
                                <option value="IAC">IAC - INACTIVIDAD</option>
                                <option value="IDL">IDL - PARO DE MAQUINA</option>
                                <option value="INC">INC - INCAPACIDAD</option>
                                <option value="INV">INV - INVENTARIO</option>
                                <option value="LLI">LLI - LLUVIA O INUNDACIÓN</option>
                                <option value="MCO">MCO - MTTO CORRECTIVO</option>
                                <option value="MIP">MIP - MOVIMIENTOS INTERNOS PRODUCCIÓN</option>
                                <option value="MPR">MPR - MTTO PREVENTIVO</option>
                                <option value="MYP">MYP - MODELOS Y PROTOTIPOS</option>
                                <option value="OYA">OYA - ORDEN Y ASEO</option>
                                <option value="PAC">PAC - PAUSA ACTIVA</option>
                                <option value="PER">PER - PERMISO</option>
                                <option value="PL">PL - PINTURA LINEAS DE AREAS</option>
                                <option value="PME">PME - PROYECTO MEJORA</option>
                                <option value="RCI">RCI - REUNIONES - CAPACITACIONES INGENIERÍA</option>
                                <option value="RCP">RCP - REUNIONES - CAPACITACIONES PRODUCCIÓN</option>
                                <option value="RCS">RCS - REUNIONES - CAPACITACIONES SOPORTE</option>
                                <option value="RIT">RIT - REUNIÓN INICIO TURNO</option>
                                <option value="SPR">SPR - SOPORTE PRODUCCIÓN</option>
                                <option value="SUP">SUP - SUPERVISIÓN</option>
                                <option value="VAC">VAC - VACACIONES</option>
                            </select>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="hora-inicio-indirectos">Hora Inicio</label>
                                <input type="time" id="hora-inicio-indirectos">
                            </div>
                            <div class="form-group">
                                <label for="hora-fin-indirectos">Hora Fin</label>
                                <input type="time" id="hora-fin-indirectos">
                            </div>
                        </div>
                        <button class="btn-register" id="btn-registrar-indirectos">Registrar</button>
                    </div>
                </div>
            </main>
        </div>
        
        <div class="tab-content" id="consulta-tab">
            <div class="consult-section">
                <h2>Consultar Registros de Horas</h2>
                <div class="consult-controls">
                    <div class="form-group">
                        <label for="consult-employee">Empleado</label>
                        <select id="consult-employee">
                            <option value="">Todos los empleados</option>
                            <!-- Las opciones se cargarán dinámicamente -->
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="consult-type">Tipo de Registro</label>
                        <select id="consult-type">
                            <option value="">Todos los tipos</option>
                            <option value="ejecuciones">Ejecuciones</option>
                            <option value="indirectos">Indirectos</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="consult-date">Fecha</label>
                        <input type="date" id="consult-date">
                    </div>
                    <button class="btn-consult" id="btn-consultar">Consultar</button>
                </div>
                
                <div id="consult-results">
                    <table class="results-table hidden" id="results-table">
                        <thead>
                            <tr>
                                <th>Fecha</th>
                                <th>Empleado</th>
                                <th>Tipo</th>
                                <th>Detalles</th>
                                <th>Hora Inicio</th>
                                <th>Hora Fin</th>
                            </tr>
                        </thead>
                        <tbody id="results-body">
                            <!-- Los resultados se cargarán aquí -->
                        </tbody>
                    </table>
                    <div class="no-results hidden" id="no-results">
                        No se encontraron registros con los criterios seleccionados.
                    </div>
                </div>
                
                <div class="action-buttons">
                    <button class="btn-download" id="btn-download-excel">Descargar Excel</button>
                    <button class="btn-delete" id="btn-delete-records">Borrar Todos los Registros</button>
                </div>
                
                <div class="password-prompt hidden" id="password-prompt">
                    <h3>Confirmar Eliminación</h3>
                    <p>Esta acción eliminará <strong>todos los registros</strong> de forma permanente. Para continuar, ingrese la contraseña de administrador:</p>
                    <div class="password-input-group">
                        <input type="password" id="admin-password" placeholder="Contraseña de administrador">
                        <button class="btn-confirm" id="btn-confirm-delete">Confirmar</button>
                        <button class="btn-cancel" id="btn-cancel-delete">Cancelar</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="notification" id="notification">Registro guardado exitosamente</div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const employeeIdInput = document.getElementById('employee-id');
            const employeeNameDiv = document.getElementById('employee-name');
            const sectionEjecuciones = document.getElementById('section-ejecuciones');
            const sectionIndirectos = document.getElementById('section-indirectos');
            const btnRegistrarEjecuciones = document.getElementById('btn-registrar-ejecuciones');
            const btnRegistrarIndirectos = document.getElementById('btn-registrar-indirectos');
            const notification = document.getElementById('notification');
            const tabs = document.querySelectorAll('.tab');
            const tabContents = document.querySelectorAll('.tab-content');
            const btnConsultar = document.getElementById('btn-consultar');
            const resultsTable = document.getElementById('results-table');
            const resultsBody = document.getElementById('results-body');
            const noResults = document.getElementById('no-results');
            const btnDownloadExcel = document.getElementById('btn-download-excel');
            const btnDeleteRecords = document.getElementById('btn-delete-records');
            const lockEjecuciones = document.getElementById('lock-ejecuciones');
            const lockIndirectos = document.getElementById('lock-indirectos');
            const consultEmployeeSelect = document.getElementById('consult-employee');
            const passwordPrompt = document.getElementById('password-prompt');
            const adminPasswordInput = document.getElementById('admin-password');
            const btnConfirmDelete = document.getElementById('btn-confirm-delete');
            const btnCancelDelete = document.getElementById('btn-cancel-delete');
            
            // Variables para controlar el estado de las secciones
            let ejecucionesHasData = false;
            let indirectosHasData = false;
            
            // Base de datos simulada (en un caso real, esto vendría de una API)
            let database = JSON.parse(localStorage.getItem('horasHombreDB')) || [];
            
            // Mapeo completo de códigos a nombres
            const employees = {
                'E1': 'Alvarez, Argemiro',
                'E2': 'Cabarcas Cervantes, Carlos',
                'E3': 'Cabrera Anaya, Marlon',
                'E4': 'Carmona Chamorro, Franklin',
                'E5': 'Cuadro, Dairo',
                'E6': 'Florez Cota, Jarlys',
                'E7': 'Garay, Robinson',
                'E8': 'Hernandez Banquez, Jhonny',
                'E9': 'Jaramillo Velasquez, Rolando',
                'E10': 'Julio Hernandez, Alejandro',
                'E11': 'Malo Narvaez, Hector',
                'E12': 'Martinez Romero, Javier',
                'E13': 'Medina Batista, Kaner',
                'E14': 'Monterrosa Ealo, Miguell',
                'E15': 'Nuñez Guardo, Dario',
                'E16': 'Parra Gonzalez, Hernando',
                'E17': 'Polo Florez, Victor',
                'E18': 'Romero Julio, German',
                'E19': 'Secca Valdez, Victor',
                'E20': 'Tamara Correa, Francisco',
                'E21': 'Rios Morales, Cristian',
                'E22': 'Valdivieso Mercado, Lucas',
                'E23': 'Ahumedo Salcedo, Michael',
                'E24': 'Arnedo Angulo, Eloisa',
                'E25': 'Carballo Zarate, Virgoe',
                'E26': 'Mass Montes, Elvira',
                'E27': 'Rodriguez Garcia, Ronald',
                'E28': 'Cuellar Narvaez, Alvaro',
                'E29': 'Thiriez Ochoa, Philippe',
                'E30': 'Cuadro Blanco, Mileyda',
                'E31': 'Perez Garcia, Zoraida',
                'E32': 'Salgado Martinez, Jennifer',
                'E33': 'Consuegra Carmona, Carolina',
                'E34': 'Segrera Calderon, Enrique',
                'E35': 'Carmona Marimon, Delimiro',
                'E36': 'Choperena Mariotte, Jose',
                'E37': 'De Avila Yepes, Francisco',
                'E38': 'Donado Ospino, Dalmiro',
                'E39': 'Gomez Ortiz, Edgar',
                'E40': 'Hernandez Castillo, Elias',
                'E41': 'Martinez Caro, Rafael',
                'E42': 'Mercado Caraballo, Pedro',
                'E43': 'Narvaez Martelo, Alberth',
                'E44': 'Narvaez Miranda, Walberto',
                'E45': 'Olivo Jimenez, Wilmer',
                'E46': 'Osorio Vargas, Rafael',
                'E47': 'Paternina Llamas, Moises',
                'E48': 'Ruiz Carvajal, Rodolfo',
                'E49': 'Ruiz Perez, Jorge',
                'E50': 'Stevenson Mantilla, Wilmer',
                'E51': 'Torres Buelvas, Neil',
                'E52': 'Valero Simanca, Antony',
                'E53': 'Escalante Rodriguez, Yuliana',
                'E54': 'Ocampo Gandara, Juana',
                'E55': 'Pallares Guapi, Claudia',
                'E56': 'Gomez Bilbao, Henry',
                'E57': 'Iglesia Muñoz, Henry',
                'E58': 'Morante Villanes, David',
                'E59': 'Nuñez Donado, Cesar',
                'E60': 'Ochoa Andrade, Alfonso',
                'E61': 'Perez Pozuelo, Eduardo',
                'E62': 'Solana Herrera, Andres',
                'E63': 'Torres Montes, Adrian',
                'E64': 'Vargas Montes, Antonio',
                'E65': 'Morales Joyro, Jose',
                'E66': 'Pacheco Valencia, Bonifacio',
                'E67': 'Payares Campo, Carlos',
                'E68': 'Torres Grau, Milton',
                'E69': 'Barragan Vega, Carlos',
                'E70': 'Marchan Marrugo, Luis Eduardo',
                'E71': 'Cabarcas Mendoza, Jeickson',
                'E72': 'De Arco Castillo, Kevin',
                'E73': 'Gomez Villero, Yorman',
                'E74': 'Guerrero Berrio, Carlos',
                'E75': 'Guerrero Cabarcas, Carlos',
                'E76': 'Julio Mariote, Jarol',
                'E77': 'Leiva Lopez, Raul',
                'E78': 'Lopez Roca, Bairon',
                'E79': 'Marimon Vidal, Duban',
                'E80': 'Martinez Valdez, Jonimo',
                'E81': 'Rebolledo Morales, Norberto',
                'E82': 'Tapias Rojas, Raul',
                'E83': 'Torres Fuentes, Jorvis',
                'E84': 'Beleños Diago, Rafael',
                'E85': 'Vasquez Garcia, Pedro',
                'E86': 'Castilla Gazabon, Fanor',
                'E87': 'Altamar Carmona, Jorge',
                'E88': 'Atencia Romero, Julio',
                'E89': 'Barrios Florez, Luis',
                'E90': 'Benitez Otero, Jorge',
                'E91': 'Blanquicet Hernandez, Carmelo',
                'E92': 'Bonilla Carmona, Uberney',
                'E93': 'Caraballo Mendoza, Kevin',
                'E94': 'Carmona Bello, Jolver',
                'E95': 'Carmona Moreno, Norris',
                'E96': 'Chamorro Chamorro, Douglas',
                'E97': 'Coneo Berrio, Ferney',
                'E98': 'Espitia Perez, Juan',
                'E99': 'Fernandez Berdugo, Lesly',
                'E100': 'Fernandez Perez, Jorge',
                'E101': 'Gazabon Rodriguez, Luis',
                'E102': 'Gomez Seña, Simon',
                'E103': 'Guerrero Sanchez, Mario Jose',
                'E104': 'Jimenez Reales, Juan',
                'E105': 'Jimenez Reales, Luis',
                'E106': 'Julio Rodriguez, Yair',
                'E107': 'Mallarino Alcazar, Ericson',
                'E108': 'Marrugo Doval, Carlos',
                'E109': 'Martinez Diaz, Jose',
                'E110': 'Martinez Fortich, Udalbi',
                'E111': 'Mercado Vargas, Henry',
                'E112': 'Meza Pajaro, Ferney',
                'E113': 'Morales Marquez, Rafael',
                'E114': 'Padilla Pedraza, Walter',
                'E115': 'Palacio Soto, Leonardo',
                'E116': 'Perez Correa, Emerson',
                'E117': 'Perez Rodriguez, Faustino',
                'E118': 'Pineda Rivas, Rafael',
                'E119': 'Polo Serrano, Omar',
                'E120': 'Prada Salas, David',
                'E121': 'Villegas Rojas, Elkin',
                'E122': 'Zambrano Diaz, Jesus',
                'E123': 'Guerrero Duran, Boris',
                'E124': 'Herrera Salabarria, Henry',
                'E125': 'Julio Prins, Jensy',
                'E126': 'Laguna Chamorro, Tania',
                'E127': 'Miranda Jimenez, Juan',
                'E128': 'Tamara Perez, Ivan',
                'E129': 'Meza Urueta, Glendi',
                'E130': 'Forbes Orozco, Victor',
                'E131': 'Angulo Beltran, Rodolfo',
                'E132': 'Camacho Cabarcas, Yina',
                'E133': 'Castellano Mendoza, Keider',
                'E134': 'Fernandez Buelvas, Adelaida',
                'E135': 'Galvis Jimenez, Jainner',
                'E136': 'Hidalgo Ortega, Yiris',
                'E137': 'Mangones Peinado, Cesar',
                'E138': 'Olivera Vergara, Jahansson',
                'E139': 'Ortega Pua, Emperatriz',
                'E140': 'Pereira Alvarez, Sandra',
                'E141': 'Pestana Canchila, Jose',
                'E142': 'Sierra Silva, Sandis',
                'E143': 'Torres Medina, Edwin',
                'E144': 'Galan Viaña, Elkin',
                'E145': 'Solipa Julio, Jairo',
                'E146': 'Camargo Mejia, Marisol',
                'E147': 'Magri Gaviria, Karen',
                'E148': 'Atencio Montalvo, Jhon',
                'E149': 'Diaz Luna, Yesid',
                'E150': 'Miranda Amador, Jorge',
                'E151': 'Murillo Lozano, Miguel',
                'E152': 'Pajaro Rodriguez, Kevin',
                'E153': 'Perez Gutierrez, Juan',
                'E154': 'Puello Burgos, Andres',
                'E155': 'Coneo Posada, Esteban Alejand',
                'E156': 'Fernandez Julio, Caleb Jose',
                'E157': 'Rivera Julio, Pamela Alexandr',
                'E158': 'Vuelvas Torres, Yira Cecilia',
                'E159': 'Cerra Romero, Brayan Antonio',
                'E160': 'Hernandez Mato, Abrahan',
                'E161': 'Betin Valiente, James',
                'E162': 'Villareal Cervantes, Eduardo Jose',
                'E163': 'Navarro Gelis, Jose Manuel',
                'E164': 'Cuellar, Alvaro',
                'E165': 'Coneo, Esteban',
                'E166': 'De las Aguas Cantillo, Valerie',
                'E167': 'Carmona Navarro, Nicolas',
                'E168': 'Ortega Perez, Jairo Esteban',
                'E169': 'Diaz Caicedo, Argenis Amanda',
                'E170': 'Sampallo Barrios, Sara',
                'E172': 'Cerra Romero, Brayan Antonio',
                'E173': 'Carmona Navarro, Nicolas',
                'E174': 'Marchan Marrugo, Luis Eduardo',
                'E175': 'Morales Joyro, Jose Rodolfo',
                'E176': 'Caraballo Zapata, Henry',
                'E177': 'Puello Polo, Jhonny Jose',
                'E178': 'Ramos Tejeda, Gustavo Adolfo',
                'E179': 'Salcedo Galan, Merwil',
                'E180': 'Ballesteros Castillo, Juan David',
                'E200': 'Zuñiga Acosta, Kevin',
                'E204': 'Cardales Navarro, Edgar'
            };
            
            // Función para poblar el select de empleados en consulta
            function populateEmployeeSelect() {
                consultEmployeeSelect.innerHTML = '<option value="">Todos los empleados</option>';
                
                for (const [id, nombre] of Object.entries(employees)) {
                    const option = document.createElement('option');
                    option.value = id;
                    option.textContent = `${id} - ${nombre}`;
                    consultEmployeeSelect.appendChild(option);
                }
            }
            
            // Función para verificar si una sección tiene datos ingresados
            function sectionHasData(sectionId) {
                if (sectionId === 'section-ejecuciones') {
                    const orden = document.getElementById('orden').value;
                    const sufijo = document.getElementById('sufijo').value;
                    const operacion = document.getElementById('operacion').value;
                    const horaInicio = document.getElementById('hora-inicio-ejecuciones').value;
                    const horaFin = document.getElementById('hora-fin-ejecuciones').value;
                    
                    return orden || sufijo || operacion || horaInicio || horaFin;
                } else if (sectionId === 'section-indirectos') {
                    const actividad = document.getElementById('actividad').value;
                    const horaInicio = document.getElementById('hora-inicio-indirectos').value;
                    const horaFin = document.getElementById('hora-fin-indirectos').value;
                    
                    return actividad || horaInicio || horaFin;
                }
                return false;
            }
            
            // Función para actualizar el estado de las secciones
            function updateSectionStates() {
                ejecucionesHasData = sectionHasData('section-ejecuciones');
                indirectosHasData = sectionHasData('section-indirectos');
                
                // Actualizar indicadores visuales
                if (ejecucionesHasData) {
                    sectionIndirectos.classList.add('disabled');
                    lockEjecuciones.classList.remove('hidden');
                    sectionEjecuciones.classList.add('locked');
                } else {
                    sectionIndirectos.classList.remove('disabled');
                    lockEjecuciones.classList.add('hidden');
                    sectionEjecuciones.classList.remove('locked');
                }
                
                if (indirectosHasData) {
                    sectionEjecuciones.classList.add('disabled');
                    lockIndirectos.classList.remove('hidden');
                    sectionIndirectos.classList.add('locked');
                } else {
                    sectionEjecuciones.classList.remove('disabled');
                    lockIndirectos.classList.add('hidden');
                    sectionIndirectos.classList.remove('locked');
                }
            }
            
            // Función para guardar en la base de datos simulada
            function saveToDatabase(data) {
                database.push(data);
                localStorage.setItem('horasHombreDB', JSON.stringify(database));
                return Promise.resolve(true);
            }
            
            // Función para consultar la base de datos
            function queryDatabase(filters) {
                let results = database;
                
                if (filters.employee) {
                    results = results.filter(record => record.empleado.id === filters.employee);
                }
                
                if (filters.type) {
                    results = results.filter(record => record.tipo === filters.type);
                }
                
                if (filters.date) {
                    results = results.filter(record => {
                        const recordDate = new Date(record.fecha).toISOString().split('T')[0];
                        return recordDate === filters.date;
                    });
                }
                
                return results;
            }
            
            // Función para mostrar notificación
            function showNotification(message, isError = false) {
                notification.textContent = message;
                notification.classList.remove('error');
                
                if (isError) {
                    notification.classList.add('error');
                }
                
                notification.classList.add('show');
                setTimeout(() => {
                    notification.classList.remove('show');
                }, 3000);
            }
            
            // Función para mostrar resultados de consulta
            function displayResults(results) {
                resultsBody.innerHTML = '';
                
                if (results.length === 0) {
                    resultsTable.classList.add('hidden');
                    noResults.classList.remove('hidden');
                    return;
                }
                
                noResults.classList.add('hidden');
                resultsTable.classList.remove('hidden');
                
                results.forEach(record => {
                    const row = document.createElement('tr');
                    
                    // Formatear fecha
                    const date = new Date(record.fecha);
                    const formattedDate = `${date.getDate().toString().padStart(2, '0')}/${(date.getMonth() + 1).toString().padStart(2, '0')}/${date.getFullYear()}`;
                    
                    // Formatear detalles según el tipo
                    let detalles = '';
                    if (record.tipo === 'ejecuciones') {
                        detalles = `Orden: ${record.orden}, Sufijo: ${record.sufijo}, Operación: ${record.operacion}`;
                    } else {
                        detalles = `Actividad: ${record.actividad}`;
                    }
                    
                    row.innerHTML = `
                        <td>${formattedDate}</td>
                        <td>${record.empleado.id} - ${record.empleado.nombre}</td>
                        <td>${record.tipo === 'ejecuciones' ? 'Ejecuciones' : 'Indirectos'}</td>
                        <td>${detalles}</td>
                        <td>${record.horaInicio}</td>
                        <td>${record.horaFin}</td>
                    `;
                    
                    resultsBody.appendChild(row);
                });
            }
            
            // Función para descargar Excel
            function downloadExcel() {
                if (database.length === 0) {
                    showNotification('No hay registros para descargar', true);
                    return;
                }
                
                // Crear libro de trabajo
                const wb = XLSX.utils.book_new();
                
                // Preparar datos para Excel
                const excelData = database.map(record => {
                    const date = new Date(record.fecha);
                    const formattedDate = `${date.getDate().toString().padStart(2, '0')}/${(date.getMonth() + 1).toString().padStart(2, '0')}/${date.getFullYear()}`;
                    
                    if (record.tipo === 'ejecuciones') {
                        return {
                            'Fecha': formattedDate,
                            'ID Empleado': record.empleado.id,
                            'Nombre Empleado': record.empleado.nombre,
                            'Tipo': 'Ejecuciones',
                            'Orden': record.orden,
                            'Sufijo': record.sufijo,
                            'Operación': record.operacion,
                            'Hora Inicio': record.horaInicio,
                            'Hora Fin': record.horaFin
                        };
                    } else {
                        return {
                            'Fecha': formattedDate,
                            'ID Empleado': record.empleado.id,
                            'Nombre Empleado': record.empleado.nombre,
                            'Tipo': 'Indirectos',
                            'Actividad': record.actividad,
                            'Hora Inicio': record.horaInicio,
                            'Hora Fin': record.horaFin
                        };
                    }
                });
                
                // Crear hoja de trabajo
                const ws = XLSX.utils.json_to_sheet(excelData);
                
                // Agregar hoja al libro
                XLSX.utils.book_append_sheet(wb, ws, 'Registros Horas Hombre');
                
                // Descargar archivo
                XLSX.writeFile(wb, 'registros_horas_hombre.xlsx');
                showNotification('Excel descargado exitosamente');
            }
            
            // Función para borrar todos los registros
            function deleteAllRecords() {
                database = [];
                localStorage.setItem('horasHombreDB', JSON.stringify(database));
                showNotification('Todos los registros han sido eliminados');
                
                // Actualizar la vista de resultados
                const results = queryDatabase({});
                displayResults(results);
                
                // Ocultar el prompt de contraseña
                passwordPrompt.classList.add('hidden');
                adminPasswordInput.value = '';
            }
            
            // Detectar cuando se ingresa un ID de empleado
            employeeIdInput.addEventListener('input', function() {
                const code = this.value.trim().toUpperCase();
                
                if (employees[code]) {
                    employeeNameDiv.textContent = employees[code];
                    employeeNameDiv.classList.remove('hidden');
                } else {
                    employeeNameDiv.classList.add('hidden');
                }
            });
            
            // Permitir que el campo se limpie al presionar Escape
            employeeIdInput.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    this.value = '';
                    employeeNameDiv.classList.add('hidden');
                }
            });
            
            // Activar/desactivar secciones al hacer clic
            sectionEjecuciones.addEventListener('click', function() {
                if (this.classList.contains('disabled')) return;
                
                this.classList.add('active');
                sectionIndirectos.classList.remove('active');
            });
            
            sectionIndirectos.addEventListener('click', function() {
                if (this.classList.contains('disabled')) return;
                
                this.classList.add('active');
                sectionEjecuciones.classList.remove('active');
            });
            
            // Monitorear cambios en los campos de entrada
            const inputsEjecuciones = document.querySelectorAll('#section-ejecuciones input, #section-ejecuciones select');
            const inputsIndirectos = document.querySelectorAll('#section-indirectos input, #section-indirectos select');
            
            inputsEjecuciones.forEach(input => {
                input.addEventListener('input', updateSectionStates);
            });
            
            inputsIndirectos.forEach(input => {
                input.addEventListener('input', updateSectionStates);
            });
            
            // Cambiar pestañas
            tabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    
                    // Actualizar pestañas activas
                    tabs.forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Actualizar contenido activo
                    tabContents.forEach(content => content.classList.remove('active'));
                    document.getElementById(`${tabId}-tab`).classList.add('active');
                });
            });
            
            // Registrar datos de ejecuciones
            btnRegistrarEjecuciones.addEventListener('click', async function() {
                const employeeId = employeeIdInput.value.trim().toUpperCase();
                
                if (!employees[employeeId]) {
                    alert('Por favor, ingrese un ID de empleado válido');
                    return;
                }
                
                const orden = document.getElementById('orden').value;
                const sufijo = document.getElementById('sufijo').value;
                const operacion = document.getElementById('operacion').value;
                const horaInicio = document.getElementById('hora-inicio-ejecuciones').value;
                const horaFin = document.getElementById('hora-fin-ejecuciones').value;
                
                if (!orden || !sufijo || !operacion || !horaInicio || !horaFin) {
                    alert('Por favor, complete todos los campos de la sección Ejecuciones');
                    return;
                }
                
                const data = {
                    tipo: 'ejecuciones',
                    empleado: {
                        id: employeeId,
                        nombre: employees[employeeId]
                    },
                    orden: orden,
                    sufijo: sufijo,
                    operacion: operacion,
                    horaInicio: horaInicio,
                    horaFin: horaFin,
                    fecha: new Date().toISOString()
                };
                
                // Guardar en base de datos
                const success = await saveToDatabase(data);
                
                if (success) {
                    showNotification('Registro de ejecuciones guardado exitosamente');
                    // Limpiar formulario
                    document.getElementById('orden').value = '';
                    document.getElementById('sufijo').value = '';
                    document.getElementById('operacion').value = '';
                    document.getElementById('hora-inicio-ejecuciones').value = '';
                    document.getElementById('hora-fin-ejecuciones').value = '';
                    
                    // Actualizar estado de secciones después de limpiar
                    updateSectionStates();
                    
                    // NOTA: Ya no se descarga Excel automáticamente
                } else {
                    alert('Error al guardar el registro. Intente nuevamente.');
                }
            });
            
            // Registrar datos de indirectos
            btnRegistrarIndirectos.addEventListener('click', async function() {
                const employeeId = employeeIdInput.value.trim().toUpperCase();
                
                if (!employees[employeeId]) {
                    alert('Por favor, ingrese un ID de empleado válido');
                    return;
                }
                
                const actividad = document.getElementById('actividad').value;
                const horaInicio = document.getElementById('hora-inicio-indirectos').value;
                const horaFin = document.getElementById('hora-fin-indirectos').value;
                
                if (!actividad || !horaInicio || !horaFin) {
                    alert('Por favor, complete todos los campos de la sección Indirectos');
                    return;
                }
                
                const data = {
                    tipo: 'indirectos',
                    empleado: {
                        id: employeeId,
                        nombre: employees[employeeId]
                    },
                    actividad: actividad,
                    horaInicio: horaInicio,
                    horaFin: horaFin,
                    fecha: new Date().toISOString()
                };
                
                // Guardar en base de datos
                const success = await saveToDatabase(data);
                
                if (success) {
                    showNotification('Registro de indirectos guardado exitosamente');
                    // Limpiar formulario
                    document.getElementById('actividad').value = '';
                    document.getElementById('hora-inicio-indirectos').value = '';
                    document.getElementById('hora-fin-indirectos').value = '';
                    
                    // Actualizar estado de secciones después de limpiar
                    updateSectionStates();
                    
                    // NOTA: Ya no se descarga Excel automáticamente
                } else {
                    alert('Error al guardar el registro. Intente nuevamente.');
                }
            });
            
            // Consultar registros
            btnConsultar.addEventListener('click', function() {
                const employee = document.getElementById('consult-employee').value;
                const type = document.getElementById('consult-type').value;
                const date = document.getElementById('consult-date').value;
                
                const filters = {
                    employee: employee,
                    type: type,
                    date: date
                };
                
                const results = queryDatabase(filters);
                displayResults(results);
            });
            
            // Descargar Excel
            btnDownloadExcel.addEventListener('click', downloadExcel);
            
            // Mostrar prompt para borrar registros
            btnDeleteRecords.addEventListener('click', function() {
                if (database.length === 0) {
                    showNotification('No hay registros para eliminar', true);
                    return;
                }
                passwordPrompt.classList.remove('hidden');
            });
            
            // Cancelar eliminación
            btnCancelDelete.addEventListener('click', function() {
                passwordPrompt.classList.add('hidden');
                adminPasswordInput.value = '';
            });
            
            // Confirmar eliminación
            btnConfirmDelete.addEventListener('click', function() {
                const password = adminPasswordInput.value;
                
                if (password === 'Admin0000') {
                    deleteAllRecords();
                } else {
                    showNotification('Contraseña incorrecta', true);
                    adminPasswordInput.value = '';
                }
            });
            
            // Permitir confirmar con Enter
            adminPasswordInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    btnConfirmDelete.click();
                }
            });
            
            // Cargar todos los registros al abrir la pestaña de consulta por primera vez
            document.querySelector('.tab[data-tab="consulta"]').addEventListener('click', function() {
                if (resultsBody.children.length === 0) {
                    const results = queryDatabase({});
                    displayResults(results);
                }
            });
            
            // Inicializar el estado de las secciones y poblar el select de empleados
            updateSectionStates();
            populateEmployeeSelect();
        });
    </script>
</body>

</html>
